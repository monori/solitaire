<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Play classic Klondike Solitaire online or offline. Save your progress with bookmarks and track your stats. Non-intrusive ads, mobile-friendly design.">
    <meta name="keywords" content="solitaire, klondike, card game, online game, offline game, free game, patience, cards, spider solitaire, freecell, pyramid solitaire, tripeaks, yukon, canfield, golf solitaire, forty thieves, accordion, clock solitaire, gaps, montana, scorpion, wasp, beleaguered castle, eight off, baker's dozen, cruel, la belle lucie, fan, shamrocks, three peaks, penguin, flower garden, grandfather's clock, bristol, calculation, fortress, good measure, little spider, maze, miss milligan, nestor, penguin, pyramid, russian solitaire, sir tommy, spiderette, sultan, thieves of egypt, trefoil, triple peaks, westcliff, will o the wisp, zebra">
    <meta name="author" content="Free Online Solitaire">
    <meta name="robots" content="index, follow">
    <meta name="language" content="en">
    
    <!-- PWA and Offline Support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#2c8a43">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Solitaire">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://free-solitaire-original.com/">
    <meta property="og:title" content="Free Online Solitaire - Classic Klondike Card Game">
    <meta property="og:description" content="Play classic Klondike Solitaire online or offline. Save your progress and track your stats!">
    <meta property="og:image" content="https://free-solitaire-original.com/solitaire-preview.jpg">
    <meta property="og:locale" content="en_US">
    
    <!-- Alternate language versions -->
    <link rel="alternate" hreflang="en" href="https://free-solitaire-original.com/">
    <link rel="alternate" hreflang="da" href="https://gratis-7-kabale.dk/">
    <link rel="alternate" hreflang="x-default" href="https://free-solitaire-original.com/">
    
    <title>Free Online Solitaire - Classic Klondike Card Game</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Game",
        "name": "Free Online Solitaire",
        "description": "Classic Klondike Solitaire card game with save functionality and statistics tracking",
        "genre": "Card Game",
        "gamePlatform": "Web Browser",
        "operatingSystem": "Any",
        "applicationCategory": "Game",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "ratingCount": "1247"
        },
        "gameItem": {
            "@type": "Thing",
            "name": "Playing Cards"
        },
        "numberOfPlayers": "1",
        "playMode": "SinglePlayer",
        "inLanguage": "en"
    }
    </script>
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Free Online Solitaire - Classic Klondike Card Game">
    <meta name="twitter:description" content="Play classic Klondike Solitaire online or offline. Save your progress and track your stats!">
    <meta name="twitter:image" content="https://free-solitaire-original.com/solitaire-preview.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://free-solitaire-original.com/">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://pagead2.googlesyndication.com">
    <link rel="preconnect" href="https://www.googletagmanager.com">
    
    <!-- Google AdSense Account -->
    <meta name="google-adsense-account" content="ca-pub-9436704170013305">
</head>
<body data-lang="en">
    <div class="game-container">
        <!-- Offline Mode Indicator -->
        <div class="offline-indicator">
            🔌 Playing Offline - Progress saved locally
        </div>
        
        <header>
            <h1>Solitaire</h1>
            <div class="game-controls">
                <button id="new-game-btn">New Game</button>
                <button id="undo-btn">Undo</button>
                <button id="bookmark-btn" class="bookmark-btn" title="Save your progress by bookmarking this page">
                    📌 Save Progress
                </button>
                <div class="draw-option">
                    <label for="draw-three-toggle">Draw Three:</label>
                    <input type="checkbox" id="draw-three-toggle">
                </div>
            </div>
        </header>

        <div class="game-area">
            <div class="top-row">
                <div class="stock-waste">
                    <div id="stock" class="pile"></div>
                    <div id="waste" class="pile"></div>
                </div>
                <div class="foundations">
                    <div id="foundation-0" class="pile foundation"></div>
                    <div id="foundation-1" class="pile foundation"></div>
                    <div id="foundation-2" class="pile foundation"></div>
                    <div id="foundation-3" class="pile foundation"></div>
                </div>
            </div>

            <div class="tableau">
                <div id="tableau-0" class="pile tableau-pile"></div>
                <div id="tableau-1" class="pile tableau-pile"></div>
                <div id="tableau-2" class="pile tableau-pile"></div>
                <div id="tableau-3" class="pile tableau-pile"></div>
                <div id="tableau-4" class="pile tableau-pile"></div>
                <div id="tableau-5" class="pile tableau-pile"></div>
                <div id="tableau-6" class="pile tableau-pile"></div>
            </div>
        </div>

        <div class="stats-container">
            <div class="stats">
                <span>Games: <span id="games-played">0</span></span>
                <span>Wins: <span id="wins">0</span></span>
                <span>Losses: <span id="losses">0</span></span>
                <span>Fastest: <span id="fastest-time">--:--</span></span>
            </div>
        </div>

        <div class="toast-container" id="toast-container">
            <!-- Toast notifications will be added here dynamically -->
        </div>
    </div>

    <!-- Ad Section - Above SEO Content -->
    <div class="ad-section">
        <!-- Subtle bottom ad - only visible when scrolled down -->
        <div class="ad-container ad-subtle-bottom">
            <div class="ad-placeholder">📢 Advertisement Slot</div>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-9436704170013305"
                 data-ad-slot="2056797013"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <!-- Desktop side ads - only on very wide screens, minimal and blended -->
        <div class="ad-container ad-subtle-side ad-left">
            <div class="ad-placeholder">📢 Ad Slot</div>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-9436704170013305"
                 data-ad-slot="2304209025"
                 data-ad-format="vertical"></ins>
        </div>

        <div class="ad-container ad-subtle-side ad-right">
            <div class="ad-placeholder">📢 Ad Slot</div>
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-9436704170013305"
                 data-ad-slot="7972318738"
                 data-ad-format="vertical"></ins>
        </div>
    </div>

    <!-- SEO Content Section - English -->
    <div class="seo-content">
        <div class="seo-section">
            <section class="game-description">
                <h2>Free Online Solitaire - Classic Klondike Card Game</h2>
                <p>Play the world's most popular card game for free! Our online Solitaire (also known as Klondike Solitaire or Patience) offers the classic gameplay you love with modern features like save functionality, statistics tracking, and offline play. No downloads required - play instantly in your browser!</p>
            </section>

            <section class="how-to-play">
                <h2>How to Play Solitaire</h2>
                <h3>Objective</h3>
                <p>The goal of Solitaire is to move all 52 cards to the four foundation piles, building each suit from Ace to King (A, 2, 3, 4, 5, 6, 7, 8, 9, 10, J, Q, K).</p>
                
                <h3>Game Setup</h3>
                <ul>
                    <li><strong>Tableau:</strong> 7 columns with 1-7 cards each, only top cards face-up</li>
                    <li><strong>Stock:</strong> Remaining cards in a face-down pile</li>
                    <li><strong>Waste:</strong> Cards drawn from the stock pile</li>
                    <li><strong>Foundations:</strong> 4 empty piles for building suits</li>
                </ul>

                <h3>How to Move Cards</h3>
                <ul>
                    <li>Drag and drop cards between piles</li>
                    <li>Build tableau columns in descending order, alternating colors</li>
                    <li>Move cards to foundations in ascending order by suit</li>
                    <li>Click stock pile to draw new cards</li>
                    <li>Double-click cards to auto-move to foundations</li>
                </ul>
            </section>

            <section class="game-features">
                <h2>Game Features</h2>
                <div class="features-grid">
                    <div class="feature">
                        <h3>🎮 Classic Gameplay</h3>
                        <p>Authentic Klondike Solitaire rules with smooth drag-and-drop controls</p>
                    </div>
                    <div class="feature">
                        <h3>💾 Save Progress</h3>
                        <p>Bookmark your game to continue later - no account required</p>
                    </div>
                    <div class="feature">
                        <h3>📊 Statistics</h3>
                        <p>Track wins, losses, games played, and fastest completion times</p>
                    </div>
                    <div class="feature">
                        <h3>📱 Mobile Friendly</h3>
                        <p>Play on any device - desktop, tablet, or smartphone</p>
                    </div>
                    <div class="feature">
                        <h3>🔌 Offline Play</h3>
                        <p>Works without internet connection once loaded</p>
                    </div>
                    <div class="feature">
                        <h3>⚡ Fast Loading</h3>
                        <p>No downloads, no registration - start playing instantly</p>
                    </div>
                </div>
            </section>

            <!-- Cookie Banner -->
            <div id="cookie-banner" class="cookie-banner">
                <div class="cookie-content">
                    <div class="cookie-text">
                        <h3>🍪 Support our free game with ads?</h3>
                        <p>We don't use any cookies by default! Only if you choose to support us with non-intrusive ads, we'll set cookies for AdSense. Otherwise, enjoy the game completely cookie-free!</p>
                    </div>
                    <div class="cookie-buttons">
                        <button id="cookie-accept-all" class="cookie-btn cookie-accept">Support Us - Show Ads</button>
                        <button id="cookie-settings-btn" class="cookie-btn cookie-settings">Customize</button>
                        <button id="cookie-reject" class="cookie-btn cookie-reject">Play Ad-Free</button>
                    </div>
                </div>
            </div>

            <section class="faq">
                <h2>Frequently Asked Questions</h2>
                <div class="faq-item">
                    <h3>Is this Solitaire game free?</h3>
                    <p>Yes! Our Solitaire game is completely free to play. No hidden costs, no premium features - enjoy unlimited games at no charge.</p>
                </div>
                <div class="faq-item">
                    <h3>Do I need to download anything?</h3>
                    <p>No downloads required! Play directly in your web browser on any device. The game works on Chrome, Firefox, Safari, Edge, and all modern browsers.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I play offline?</h3>
                    <p>Yes! Once the game loads, you can play offline. Your progress is saved locally and will sync when you're back online.</p>
                </div>
                <div class="faq-item">
                    <h3>How do I save my game?</h3>
                    <p>Simply bookmark the page (Ctrl+D or Cmd+D) to save your current game state. When you return to the bookmark, your game will continue exactly where you left off.</p>
                </div>
                <div class="faq-item">
                    <h3>What's the difference between Draw One and Draw Three?</h3>
                    <p>In Draw One mode, you draw one card at a time from the stock. Draw Three mode draws three cards, making the game more challenging.</p>
                </div>
                <div class="faq-item">
                    <h3>Can I undo moves?</h3>
                    <p>Yes! Click the "Undo" button to reverse your last move. This helps when you make mistakes or want to try different strategies.</p>
                </div>
            </section>

            <section class="solitaire-variants">
                <h2>Popular Solitaire Variants</h2>
                <p>While our game focuses on classic Klondike Solitaire, there are many other popular variants:</p>
                <ul>
                    <li><strong>Spider Solitaire:</strong> Uses two decks, build sequences in the same suit</li>
                    <li><strong>FreeCell:</strong> All cards visible, uses free cells for temporary storage</li>
                    <li><strong>Pyramid Solitaire:</strong> Remove pairs of cards that add up to 13</li>
                    <li><strong>TriPeaks:</strong> Clear three pyramid peaks by selecting cards</li>
                    <li><strong>Yukon:</strong> Similar to Klondike but with different dealing rules</li>
                </ul>
            </section>

            <section class="tips-strategies">
                <h2>Solitaire Tips & Strategies</h2>
                <ul>
                    <li>Always move Aces to foundations immediately</li>
                    <li>Expose hidden cards in tableau columns when possible</li>
                    <li>Build foundations evenly to keep options open</li>
                    <li>Don't rush to move cards to foundations - sometimes keeping them in tableau is better</li>
                    <li>Try to create empty tableau columns for Kings</li>
                    <li>Plan several moves ahead before making your move</li>
                    <li>Use the undo feature to experiment with different strategies</li>
                </ul>
            </section>

            <section class="ai-search-qa">
                <h2>Complete Guide to Solitaire</h2>
                
                <div class="qa-item">
                    <h3>What is Solitaire?</h3>
                    <p>Solitaire is a single-player card game played with a standard 52-card deck. The most popular version is Klondike Solitaire, where the objective is to move all cards to four foundation piles, building each suit from Ace to King. Solitaire has been a beloved game for centuries, offering mental exercise, relaxation, and entertainment. The digital version became famous through Microsoft Windows, introducing millions to this classic card game.</p>
                </div>

                <div class="qa-item">
                    <h3>What are the rules of Solitaire?</h3>
                    <p>Solitaire rules are straightforward: Start with 28 cards dealt into 7 tableau columns (1-7 cards each, only top cards face-up). The remaining 24 cards form the stock pile. Build foundations from Ace to King by suit. In the tableau, build down in alternating colors (red on black, black on red). You can move face-up cards between tableau columns, turn over hidden cards when exposed, and draw cards from the stock. Only Kings can be placed in empty tableau columns. The game is won when all cards are moved to the foundations.</p>
                </div>

                <div class="qa-item">
                    <h3>What is the history of Solitaire?</h3>
                    <p>Solitaire originated in Northern Europe in the late 18th century, possibly in Scandinavia or Germany. The game gained popularity in France during the Napoleonic era, where it was called "Patience." Klondike Solitaire specifically emerged during the Canadian Klondike Gold Rush (1896-1899), hence its name. The game exploded in popularity with Microsoft Windows in 1990, where it was included as a free game to help users learn mouse skills. Today, Solitaire remains one of the most played computer games worldwide.</p>
                </div>

                <div class="qa-item">
                    <h3>How do you win at Solitaire?</h3>
                    <p>To win at Solitaire, move all 52 cards to the four foundation piles in ascending order by suit (Ace through King). Start by looking for Aces and low cards to build foundations. Always expose hidden tableau cards when possible. Build tableau sequences in descending order with alternating colors. Create empty tableau columns for Kings. Don't rush to move cards to foundations - sometimes keeping them in tableau provides more strategic options. Use the undo feature to explore different moves and learn from mistakes.</p>
                </div>

                <div class="qa-item">
                    <h3>What is Klondike Solitaire?</h3>
                    <p>Klondike Solitaire is the most common version of Solitaire, often simply called "Solitaire." It uses a standard 52-card deck with specific rules: 28 cards dealt into 7 tableau columns, 4 foundation piles for each suit, and a stock pile. Players build foundations from Ace to King by suit, while building tableau columns in descending order with alternating colors. Klondike can be played in "Draw One" or "Draw Three" variants, referring to how many cards are drawn from the stock at once.</p>
                </div>

                <div class="qa-item">
                    <h3>Is Solitaire good for your brain?</h3>
                    <p>Yes, Solitaire offers several cognitive benefits. It improves problem-solving skills, pattern recognition, and strategic thinking. The game enhances memory by requiring players to remember card locations and plan sequences. Solitaire provides stress relief and mental relaxation while maintaining focus. It's particularly beneficial for older adults as a form of mental exercise that can help maintain cognitive function. The game also teaches patience, planning, and decision-making skills in a low-pressure environment.</p>
                </div>

                <div class="qa-item">
                    <h3>Can you always win Solitaire?</h3>
                    <p>Not every Solitaire game is winnable. Studies suggest that approximately 79-82% of Klondike Solitaire games are theoretically solvable with perfect play. However, achieving perfect play is extremely difficult for humans. Most players win about 10-15% of games, while experienced players might win 20-30%. The winnability depends on the initial card distribution. Draw Three games are generally harder than Draw One games, with lower win rates due to the increased difficulty of accessing cards in the stock pile.</p>
                </div>

                <div class="qa-item">
                    <h3>What's the difference between Draw One and Draw Three Solitaire?</h3>
                    <p>Draw One and Draw Three refer to how many cards you draw from the stock pile at once. In Draw One Solitaire, you draw and reveal one card at a time from the stock, making all stock cards eventually accessible. Draw Three Solitaire draws three cards at once, but only the top card is playable, making some cards potentially inaccessible. Draw One is easier and more forgiving, suitable for beginners. Draw Three is more challenging and strategic, preferred by experienced players seeking greater difficulty.</p>
                </div>

                <div class="qa-item">
                    <h3>How long does a Solitaire game take?</h3>
                    <p>A typical Solitaire game takes 5-15 minutes, depending on the player's experience and the complexity of the deal. Quick games might finish in 2-3 minutes, while challenging deals could take 20-30 minutes of careful consideration. Beginners often take longer as they learn the rules and strategies. The game's duration also depends on whether you're playing casually or trying to optimize your moves. Online versions often include timers, with competitive players aiming for faster completion times while maintaining high win rates.</p>
                </div>

                <div class="qa-item">
                    <h3>What are the most popular Solitaire variants?</h3>
                    <p>Beyond Klondike, popular Solitaire variants include: Spider Solitaire (uses two decks, builds sequences in the same suit), FreeCell (all cards visible, uses free cells for temporary storage), Pyramid Solitaire (remove pairs totaling 13), TriPeaks (clear three pyramid peaks), Yukon (similar to Klondike with different dealing), Golf Solitaire (clear tableau by building up or down), and Canfield (faster-paced with specific dealing rules). Each variant offers unique challenges and strategies while maintaining the core single-player card game appeal.</p>
                </div>
            </section>
        </div>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="privacy-policy.html">Privacy Policy</a>
                <a href="terms-of-service.html">Terms of Service</a>
                <a href="https://forms.gle/tEP1JsYkncFTQxhF8" target="_blank" rel="noopener">Contact</a>
                <a href="#" id="cookie-settings">Cookie Settings</a>
            </div>
            <div class="footer-text">
                <p>&copy; 2024 Free Solitaire Original. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Cookie Settings Modal -->
    <div id="cookie-modal" class="cookie-modal">
        <div class="cookie-modal-content">
            <div class="cookie-modal-header">
                <h2>Cookie Settings</h2>
                <button id="cookie-modal-close" class="cookie-close">&times;</button>
            </div>
            <div class="cookie-modal-body">
                <div class="cookie-category">
                    <div class="cookie-category-header">
                        <h3>Advertising Cookies</h3>
                        <label class="cookie-toggle">
                            <input type="checkbox" id="advertising-cookies">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    <p>Enable this to show non-intrusive ads that support our free game. We only set cookies if you choose ads - otherwise the game runs completely cookie-free!</p>
                </div>
            </div>
            <div class="cookie-modal-footer">
                <button id="cookie-save-settings" class="cookie-btn cookie-accept">Save Settings</button>
            </div>
        </div>
    </div>

    <script src="game.js"></script>
    
    <!-- Cookie Management Script -->
    <script>
        // Cookie consent management
        class CookieManager {
            constructor() {
                this.cookieSettings = this.loadSettings();
                this.init();
            }
            
            init() {
                // Show banner if no consent given yet
                if (!this.cookieSettings.consentGiven) {
                    this.showBanner();
                }
                
                // Initialize based on current settings
                this.applySettings();
                this.bindEvents();
            }
            
            loadSettings() {
                const stored = localStorage.getItem('cookieSettings');
                if (stored) {
                    return JSON.parse(stored);
                }
                return {
                    consentGiven: false,
                    advertising: false
                };
            }
            
            saveSettings() {
                localStorage.setItem('cookieSettings', JSON.stringify(this.cookieSettings));
            }
            
            showBanner() {
                const banner = document.getElementById('cookie-banner');
                banner.classList.add('show');
            }
            
            hideBanner() {
                const banner = document.getElementById('cookie-banner');
                banner.classList.remove('show');
            }
            
            showModal() {
                const modal = document.getElementById('cookie-modal');
                modal.classList.add('show');
                
                // Update toggle states
                document.getElementById('advertising-cookies').checked = this.cookieSettings.advertising;
            }
            
            hideModal() {
                const modal = document.getElementById('cookie-modal');
                modal.classList.remove('show');
            }
            
            acceptAll() {
                this.cookieSettings = {
                    consentGiven: true,
                    advertising: true
                };
                this.saveSettings();
                this.applySettings();
                this.hideBanner();
            }
            
            rejectNonEssential() {
                this.cookieSettings = {
                    consentGiven: true,
                    advertising: false
                };
                this.saveSettings();
                this.applySettings();
                this.hideBanner();
            }
            
            saveCustomSettings() {
                this.cookieSettings = {
                    consentGiven: true,
                    advertising: document.getElementById('advertising-cookies').checked
                };
                this.saveSettings();
                this.applySettings();
                this.hideModal();
                this.hideBanner();
            }
            
            applySettings() {
                // Load AdSense only if advertising cookies are accepted
                if (this.cookieSettings.advertising && navigator.onLine) {
                    this.loadAdSense();
                } else {
                    this.hideAds();
                }
            }
            
            loadAdSense() {
                // Only load if not already loaded
                if (!window.adsbygoogle) {
                    // Ensure ad containers are visible and have dimensions first
                    const adContainers = document.querySelectorAll('.ad-container');
                    let hasValidContainer = false;
                    
                    adContainers.forEach(container => {
                        if (container.offsetWidth > 0) {
                            hasValidContainer = true;
                        }
                    });
                    
                    // If no valid containers, wait and retry
                    if (!hasValidContainer) {
                        setTimeout(() => this.loadAdSense(), 500);
                        return;
                    }
                    
                    // Load AdSense script
                    const script = document.createElement('script');
                    script.async = true;
                    script.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9436704170013305';
                    script.crossOrigin = 'anonymous';
                    document.head.appendChild(script);
                    
                    script.onload = () => {
                        // Wait a moment for containers to be fully ready
                        setTimeout(() => {
                            try {
                                // Initialize ads with error handling
                                const adElements = document.querySelectorAll('.adsbygoogle');
                                adElements.forEach(ad => {
                                    if (ad.parentElement.offsetWidth > 0) {
                                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                                    }
                                });
                                
                                // Show ad containers
                                document.querySelectorAll('.ad-container').forEach(ad => {
                                    ad.style.display = 'flex';
                                });
                            } catch (error) {
                                console.log('AdSense initialization delayed - retrying...');
                                // Retry after a longer delay if there's an error
                                setTimeout(() => {
                                    try {
                                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                                        (window.adsbygoogle = window.adsbygoogle || []).push({});
                                    } catch (retryError) {
                                        console.log('AdSense failed to initialize after retry');
                                    }
                                }, 1000);
                            }
                        }, 100);
                    };
                    
                    script.onerror = () => {
                        console.log('AdSense script failed to load');
                    };
                }
            }
            
            hideAds() {
                // Hide all ad containers
                document.querySelectorAll('.ad-container').forEach(ad => {
                    ad.style.display = 'none';
                });
            }
            
            bindEvents() {
                // Banner buttons
                document.getElementById('cookie-accept-all').addEventListener('click', () => this.acceptAll());
                document.getElementById('cookie-reject').addEventListener('click', () => this.rejectNonEssential());
                document.getElementById('cookie-settings-btn').addEventListener('click', () => this.showModal());
                
                // Footer cookie settings link
                document.getElementById('cookie-settings').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showModal();
                });
                
                // Modal buttons
                document.getElementById('cookie-modal-close').addEventListener('click', () => this.hideModal());
                document.getElementById('cookie-save-settings').addEventListener('click', () => this.saveCustomSettings());
                
                // Close modal when clicking outside
                document.getElementById('cookie-modal').addEventListener('click', (e) => {
                    if (e.target.id === 'cookie-modal') {
                        this.hideModal();
                    }
                });
            }
        }
        
        // Initialize cookie manager when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new CookieManager();
        });
    </script>
    
    <!-- Service Worker Registration for Offline Mode -->
    <script>
        // Register service worker for offline functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New version available
                                    if (confirm('A new version is available! Reload to update?')) {
                                        newWorker.postMessage({ type: 'SKIP_WAITING' });
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
        
        // Online/Offline detection
        function updateOnlineStatus() {
            const isOnline = navigator.onLine;
            const body = document.body;
            
            if (isOnline) {
                body.classList.remove('offline');
                console.log('Online: Ads and external features available');
            } else {
                body.classList.add('offline');
                console.log('Offline: Game continues with local storage only');
            }
        }
        
        // Listen for online/offline events
        window.addEventListener('online', updateOnlineStatus);
        window.addEventListener('offline', updateOnlineStatus);
        
        // Check initial status
        updateOnlineStatus();
    </script>
</body>
</html> 